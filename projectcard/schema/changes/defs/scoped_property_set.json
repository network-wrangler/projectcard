{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "type" : "object",
    "$defs": {
        "set_num": {"type": "number", "minimum": 0},
        "change_num": {"type": "number"},
        "overwrite_scoped": {
          "type":"string",
          "enum":["all","conflicting","none"],
          "default":"none",
          "description":"If 'all', all scoped items will be overwritten. If 'conflicting', only conflicting scoped items will be overwritten. If 'none', no scoped items will be overwritten and error will be raised if there are conflicts."
        },
        "scoped_property_set_item":{
            "type": "object",
            "examples": [
              {"timespan":["7:00","9:00"],"set":0.50}
            ],
            "oneOf": [
              {
                "required": ["timespan","set"]
              },
              {
                "required": ["timespan","change"]
              },
              {
                "required": ["category","change"]
              },
              {
                "required": ["category","set"]
              }
            ],
            "properties":{
              "set": {"$ref": "#/$defs/set_num"},
              "change": {"$ref": "#/$defs/change_num"},
              "category": {"type":"array"},
              "timespan": {"$ref": "../../defs/timespan.json"},
              "overwrite_conflicting": {"type":"boolean", "default":false, "description":"If true, this item will overwrite any conflicting scoped items. If false, this item will be error if there is a conflicting item."}
              }
          }
    },
    "oneOf": [
      {
        "required": ["set","scoped"],
        "not": {"required": ["change"]}
      },
      {
        "required": ["change","group"],
        "not": {"required": ["set"]}
      }
    ],
    "properties" : {
        "existing" : {"type": ["number", "string"]},
        "set" : {"$ref": "#/$defs/set_num"},
        "change" : {"$ref": "#/$defs/change_num"},
        "scoped" : {"type":"array","items": {"$ref": "#/$defs/scoped_property_set_item"}},
        "overwrite_scoped": {"$ref": "#/$defs/overwrite_scoped"}
    }
}
